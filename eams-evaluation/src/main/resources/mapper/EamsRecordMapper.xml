<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dimple.evaluation.mapper.EamsRecordMapper">

    <resultMap type="com.dimple.evaluation.domain.Record" id="EamsRecordMap">
        <result property="recId" column="rec_id"/>
        <result property="stuId" column="stu_id"/>
        <result property="ruleId" column="rule_id"/>
        <result property="polId" column="pol_id"/>
        <result property="polStuScore" column="pol_stu_score"/>
        <result property="polStuCredence" column="pol_stu_credence"/>
        <result property="polStudentCredenceRemark" column="pol_student_credence_remark"/>
        <result property="polReviewScore" column="pol_review_score"/>
        <result property="polReviewRemark" column="pol_review_remark"/>
        <result property="reviewerName" column="reviewer_name"/>
        <result property="createBy" column="create_by"/>
        <result property="createTime" column="create_time"/>
        <result property="updateBy" column="update_by"/>
        <result property="updateTime" column="update_time"/>
    </resultMap>

    <!--查询单个-->
    <select id="selectRecordById" resultMap="EamsRecordMap">
        select
          rec_id, stu_id, rule_id, pol_id, pol_stu_score, pol_stu_credence, pol_student_credence_remark, pol_review_score, pol_review_remark, reviewer_name, create_by, create_time, update_by, update_time
        from eams.eams_record
        where rec_id = #{recId}
    </select>


    <!--通过实体作为筛选条件查询-->
    <select id="selectRecordList" resultMap="EamsRecordMap">
        select
        rec_id, stu_id, rule_id, pol_id, pol_stu_score, pol_stu_credence, pol_student_credence_remark, pol_review_score,
        pol_review_remark, reviewer_name, create_by, create_time, update_by, update_time
        from eams.eams_record
        <where>
            <if test="recId != null">
                and rec_id = #{recId}
            </if>
            <if test="stuId != null">
                and stu_id = #{stuId}
            </if>
            <if test="ruleId != null">
                and rule_id = #{ruleId}
            </if>
            <if test="polId != null">
                and pol_id = #{polId}
            </if>
            <if test="polStuScore != null">
                and pol_stu_score = #{polStuScore}
            </if>
            <if test="polStuCredence != null and polStuCredence != ''">
                and pol_stu_credence = #{polStuCredence}
            </if>
            <if test="polStudentCredenceRemark != null and polStudentCredenceRemark != ''">
                and pol_student_credence_remark = #{polStudentCredenceRemark}
            </if>
            <if test="polReviewScore != null">
                and pol_review_score = #{polReviewScore}
            </if>
            <if test="polReviewRemark != null and polReviewRemark != ''">
                and pol_review_remark = #{polReviewRemark}
            </if>
            <if test="reviewerName != null and reviewerName != ''">
                and reviewer_name = #{reviewerName}
            </if>
            <if test="params.beginTime != null and params.beginTime != ''"><!-- 开始时间检索 -->
                AND date_format(u.create_time,'%y%m%d') &gt;= date_format(#{params.beginTime},'%y%m%d')
            </if>
            <if test="params.endTime != null and params.endTime != ''"><!-- 结束时间检索 -->
                AND date_format(u.create_time,'%y%m%d') &lt;= date_format(#{params.endTime},'%y%m%d')
            </if>
        </where>
    </select>

    <!--新增所有列-->
    <insert id="insertRecord" keyProperty="recId" useGeneratedKeys="true">
        insert into eams.eams_record(stu_id, rule_id, pol_id, pol_stu_score, pol_stu_credence, pol_student_credence_remark, pol_review_score, pol_review_remark, reviewer_name, create_by, create_time, update_by, update_time)
        values (#{stuId}, #{ruleId}, #{polId}, #{polStuScore}, #{polStuCredence}, #{polStudentCredenceRemark}, #{polReviewScore}, #{polReviewRemark}, #{reviewerName}, #{createBy}, #{createTime}, #{updateBy}, #{updateTime})
    </insert>

    <!--通过主键修改数据-->
    <update id="updateRecord">
        update eams.eams_record
        <set>
            <if test="stuId != null">
                stu_id = #{stuId},
            </if>
            <if test="ruleId != null">
                rule_id = #{ruleId},
            </if>
            <if test="polId != null">
                pol_id = #{polId},
            </if>
            <if test="polStuScore != null">
                pol_stu_score = #{polStuScore},
            </if>
            <if test="polStuCredence != null and polStuCredence != ''">
                pol_stu_credence = #{polStuCredence},
            </if>
            <if test="polStudentCredenceRemark != null and polStudentCredenceRemark != ''">
                pol_student_credence_remark = #{polStudentCredenceRemark},
            </if>
            <if test="polReviewScore != null">
                pol_review_score = #{polReviewScore},
            </if>
            <if test="polReviewRemark != null and polReviewRemark != ''">
                pol_review_remark = #{polReviewRemark},
            </if>
            <if test="reviewerName != null and reviewerName != ''">
                reviewer_name = #{reviewerName},
            </if>
            <if test="createBy != null and createBy != ''">
                create_by = #{createBy},
            </if>
            <if test="createTime != null">
                create_time = #{createTime},
            </if>
            <if test="updateBy != null and updateBy != ''">
                update_by = #{updateBy},
            </if>
            <if test="updateTime != null">
                update_time = #{updateTime},
            </if>
        </set>
        where rec_id = #{recId}
    </update>

    <!--通过主键删除-->
    <delete id="deleteRecordById">
        delete from eams.eams_record where rec_id = #{recId}
    </delete>
    <delete id="deleteRecordByIds">
        delete from eams_record where rec_id in
        <foreach collection="array" item="id" separator="," open="(" close=")">
            #{id}
        </foreach>
    </delete>

</mapper>